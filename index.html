<!-- index.html -->
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Lead Extractor – Rohtext → CSV</title>
  <link rel="stylesheet" href="./app.css">
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="logo" aria-hidden="true">LE</div>
      <div class="tt">
        <div class="h">Lead Extractor</div>
        <div class="s">Offline · Rohtext → CSV · Fix/Filter/Session</div>
      </div>
    </div>
    <div class="topActions">
      <span class="chip" id="autoPill"><span class="dot y"></span>Auto</span>
      <button class="btn ghost" id="clr" title="Alles leeren">Leeren</button>
    </div>
  </header>

  <main class="grid">
    <!-- LEFT: input + controls -->
    <section class="card inputCard">
      <div class="row between">
        <div class="meta">
          <div class="k">CSV</div>
          <div class="v mono">company_name,street,zip,city,phone,email,website,source,notes</div>
        </div>
        <div class="row tight">
          <button class="btn ghost" id="normBtn">Absätze normalisieren</button>
          <label class="tog"><input id="flowOn" type="checkbox"><span>Fließtext split</span></label>
        </div>
      </div>

      <textarea id="in" class="ta" spellcheck="false" placeholder="Rohtext hier einfügen …"></textarea>

      <div class="bar">
        <div class="row wrap">
          <label class="field">
            <span>Max/CSV</span>
            <input id="max" type="number" min="1" step="1" value="5000">
          </label>

          <label class="field">
            <span>PLZ</span>
            <select id="zip">
              <option value="excel_text" selected>Excel-safe</option>
              <option value="plain">Plain</option>
            </select>
          </label>

          <label class="field">
            <span>Sort</span>
            <select id="sort">
              <option value="qdesc" selected>Ampel (best→schlecht)</option>
              <option value="qasc">Ampel (schlecht→best)</option>
              <option value="name">Firma A→Z</option>
              <option value="city">Ort A→Z</option>
              <option value="dup">Duplikate zuerst</option>
            </select>
          </label>

          <button class="btn pri" id="go">Analysieren</button>
          <button class="btn" id="exp" disabled>CSV exportieren</button>
          <button class="btn ghost" id="cpy" disabled>CSV kopieren</button>
        </div>

        <div class="row between wrap2">
          <div class="row wrap">
            <label class="tog"><input id="fltOn" type="checkbox"><span>Nur fehlende Felder</span></label>
            <label class="tog"><input id="fltE" type="checkbox" checked><span>Email</span></label>
            <label class="tog"><input id="fltP" type="checkbox" checked><span>Telefon</span></label>
            <label class="tog"><input id="fltS" type="checkbox" checked><span>Straße</span></label>
            <label class="tog"><input id="onlyG" type="checkbox"><span>Nur Grün</span></label>
          </div>

          <div class="row tight">
            <button class="btn ghost" id="saveBtn">Session speichern</button>
            <label class="btn ghost fileBtn">
              Session laden
              <input id="loadFile" type="file" accept="application/json" hidden>
            </label>
          </div>
        </div>

        <div class="split2">
          <div>
            <div class="cap">Blacklist <span class="muted">(1 Zeile pro Wort/Pattern)</span></div>
            <textarea id="bl" class="ta sm" spellcheck="false" placeholder="Bewertungen&#10;Route&#10;Speichern"></textarea>
          </div>
          <div>
            <div class="cap">Whitelist <span class="muted">(boostet Firmennamen)</span></div>
            <textarea id="wl" class="ta sm" spellcheck="false" placeholder="GmbH&#10;e.K.&#10;Praxis&#10;Bau&#10;Elektro"></textarea>
          </div>
        </div>

        <div id="err" class="err">
          <b>Fehler:</b> <span id="errMsg" class="mono"></span>
        </div>
      </div>
    </section>

    <!-- RIGHT: stats + table -->
    <section class="card outCard">
      <div class="row between">
        <div class="h2">Preview</div>
        <div id="hint" class="hint"></div>
      </div>

      <div id="st" class="stats"></div>

      <div class="tableWrap">
        <div class="tableScroll">
          <table>
            <thead><tr id="th"></tr></thead>
            <tbody id="tb"></tbody>
          </table>
        </div>
      </div>

      <div class="foot muted">
        Tipp: Klick auf eine Zeile öffnet Debug/Fix. Grün nur wenn <b>alle</b> Kernfelder gefüllt sind.
      </div>
    </section>
  </main>

  <!-- MODAL -->
  <div id="bd" class="backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="mh">
        <div class="t">Debug / Fix</div>
        <div id="ms" class="muted"></div>
        <div class="sp"></div>
        <button class="btn ghost" id="x">Schließen</button>
      </div>
      <div class="mb">
        <div class="kv" id="kv"></div>
        <div class="bb">
          <div class="bh"><b>Original-Block</b> <span class="muted">(markiert: used lines)</span></div>
          <pre id="bp"></pre>
        </div>
      </div>
      <div class="mf">
        <button class="btn pri" id="saveFix">Speichern</button>
        <button class="btn" id="cr">Zeile als CSV kopieren</button>
        <button class="btn ghost" id="x2">Schließen</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
